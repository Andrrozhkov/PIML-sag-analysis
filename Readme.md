# PIML-SAG: Physics-Informed Machine Learning for Power Line Sag Analysis

Инструмент для автоматизированного мониторинга воздушных линий электропередач с использованием компьютерного зрения и физически информированных моделей.

## Цель проекта

Автоматизированное определение критериев безопасной эксплуатации ВЛЭП на основе аэрофотосъемки с квадрокоптера.

## Основные возможности

- **Сбор данных**: Автоматизированный обход ВЛЭП с квадрокоптера
- **Обработка изображений**: Детекция проводов, изоляторов, сегментация
- **3D реконструкция**: Восстановление геометрии проводов в пространстве
- **Катенаризация**: Математическое описание проводов через уравнение цепной линии
- **Анализ безопасности**: Расчет натяжения, проверка критериев эксплуатации
- **Визуализация и отчетность**: Графики провисов, PDF-отчеты

## Архитектура проекта
```text
piml-sag-analysis/
├── src/
│ ├── data_acquisition/ # Управление квадрокоптером, планирование полета
│ ├── image_processing/ # Обработка изображений, сегментация
│ ├── geometry_reconstruction/ # 3D реконструкция, катенаризация
│ ├── physics_analysis/ # Расчет натяжения, анализ безопасности
│ └── reporting/ # Генерация отчетов, визуализация
```
* Подробнее об архитектуре можно прочитать в [документации](docs/architecture/overview.md).


## Установка
Клонируйте репозиторий:
```bash
git clone https://github.com/your-username/piml-sag-analysis.git
cd piml-sag-analysis
```

## Быстрый старт
Установите зависимости:
```bash
pip install -r requirements.txt
```

## Структура проекта:
```text
piml-sag-analysis/
|
|── .github/                          # Для GitHub-specific файлов
|   └── workflows/                    # Папка для CI/CD (опционально)
|       └── tests.yml                 # Автоматические тесты
|
|── colab/                            # Специфичные для Colab файлы
    |── install_dependencies.py       # Скрипт для установки зависимостей в Colab
    └── setup_colab.py                # Настройка среды Colab (например, монтирование Google Drive)
|
├── colab/                            # - специфично для Colab
│   ├── colab_setup.py                # Скрипт настройки среды Colab
│   ├── drive_integration.py          # Работа с Google Drive
│   ├── gpu_utils.py                  # Утилиты для работы с GPU в Colab
│   └── colab_demo.ipynb              # Демо, адаптированное под Colab
│
├── data/                             # Все, что связано с данными
│   ├── raw/                          # Исходные данные с квадрокоптера (изображения, видео, метаданные)   
│   ├── processed/                    # Предобработанные данные (сегментированные изображения, облака точек)
│   ├── synthetic/                    # Сгенерированные синтетические данные для демо
│       └── sample_flight_data.zip    # Пример данных для быстрого старта в Colab
│   └── outputs/                      # Результаты анализа (np-массивы, отчеты, графики)
│       └── data_structure.md         # Формат хранения результатов мониторинга
|
├── docs/                             # Расширенная документация
│   ├── theory/                       # Физические основы: уравнения катенарии, расчет натяжения, критерии безопасности
│   ├── images/                       # Диаграммы, схемы, скриншоты графиков
│   ├── presentation/                 # Презентации по проекту
│   └── colab_guides/                 # Pуководства по Colab
│       ├── colab_setup_guide.md
│       ├── gpu_usage_guide.md
│       └── drive_integration.md
│   └── architecture/                 # Диаграммы архитектуры системы (как та, что мы разработали)
│
├── models/                           # Обученные модели (например, для сегментации проводов и изоляторов)
│   ├── segmentation/                 # Модели для сегментации (например, U-Net)
│   └── saved_models/                 # Другие модели (если будут)
│       └── pretrained_models.zip     # Предобученные модели для быстрого старта
|
├── notebooks/                        # Jupyter Notebooks и Colab для демонстрации и экспериментов
│   ├── 01_data_exploration.ipynb
│   ├── 02_image_processing_pipeline.ipynb   # Ноутбук для демонстрации обработки изображений
│   ├── 03_3d_reconstruction.ipynb           # Ноутбук для демонстрации 3D-реконструкции
│   ├── 04_catenary_fitting.ipynb            # Ноутбук для демонстрации катенаризации
│   ├── 05_tension_analysis.ipynb            # Ноутбук для демонстрации анализа натяжения
│   └── 06_results_visualization.ipynb       # Ноутбук для визуализации результатов
│
├── colab_notebooks/                   # Ноутбуки для Colab
│   ├── 01_colab_quickstart.ipynb
│   ├── 02_full_pipeline_colab.ipynb
│   ├── 03_live_demo_colab.ipynb
│   └── 04_batch_processing_colab.ipynb
|
├── src/                               # Исходный код (основная папка)
│   ├── __init__.py                   
│   ├── data_acquisition/              # Модуль сбора данных
│   │   ├── __init__.py
│   │   ├── flight_planner.py          # Планировщик полета
│   │   └── uav_controller.py          # Контроллер квадрокоптера (если используется симуляция или реальное управление)
│   │
│   ├── data_processing/               # Модуль обработки данных
│   │   ├── __init__.py
│   │   ├── image_preprocessing.py     # Предобработка изображений (коррекция дисторсии, шумов)
│   │   ├── segmentation.py            # Сегментация проводов и опор (традиционные методы и/или нейросети)
│   │   ├── skeletonization.py         # Скелетизация проводов
│   │   ├── wire_assembly.py           # Сборка провода из нескольких изображений
│   │   └── reconstruction_3d.py       # 3D-реконструкция (SfM, стереозрение)
│   │
│   ├── catenary/                      # Модуль катенаризации
│   │   ├── __init__.py
│   │   ├── catenary_model.py          # Аппроксимация цепной линией
│   │   └── geometry_calculation.py    # Расчет провиса, длины и т.д.
│   │
│   ├── analysis/                      # Модуль анализа и расчетов
│   │   ├── __init__.py
│   │   ├── tension_calculation.py     # Расчет натяжения
│   │   ├── safety_analyzer.py         # Анализатор безопасности (перехлест, запас прочности, расстояние до земли)
│   │   └── predictive.py              # Прогнозный модуль
│   │
│   ├── visualization/                 # Модуль визуализации
│   │   ├── __init__.py
│   │   ├── plotter.py                 # Построитель графиков (2D)
│   │   └── viewer_3d.py               # 3D-вьюер
│   │
│   ├── storage_reporting/             # Модуль хранения и отчетности
│   │   ├── __init__.py
│   │   ├── data_storage.py            # Функции для сохранения в np.array и базу данных
│   │   └── report_generator.py        # Генератор отчетов (PDF, HTML)
│   │
│   └── utils/                         # Вспомогательные модули
│       ├── __init__.py
│       ├── camera_calibration.py      # Калибровка камеры
│       ├── coordinate_transforms.py   # Преобразования систем координат
│       └── constants.py               # Физические константы, параметры проводов
│
├── tests/                             # Юнит-тесты
│   ├── __init__.py
│   ├── test_data_preprocessing.py
│   ├── test_segmentation.py
│   ├── test_catenary.py
│   └── test_tension.py
│
├── .gitignore                        
├── LICENSE                           
├── README.md                         
├── requirements.txt                   # Список зависимостей (Python пакеты)
|── environment.yml                    # Альтернатива для conda
└── colab_requirements.txt             # Рекомендации (упрощенные требования) для Colab
```
## Структура данных
Данные сохраняются в формате:
```python
{
    'span_id': 105,
    'wires': [
        {
            'catenary_coeffs': [a, b, c],
            'start_node_xyz': [x1, y1, z1],
            'end_node_xyz': [x2, y2, z2],
            'sag': 5.2,
            'length': 255.7,
            'tension': 4500,
            'safety_margin': 1.8
        }
    ]
}
```
Подробнее о формате хранения результатов мониторинга в [документации](docs/architecture/DATA_STRUCTURE.md).

## Лицензия
Этот проект распространяется под лицензией MIT. Подробнее см. в файле LICENSE. 
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

```text
Этот подход позволит четко структурировать проект и сделать его понятным для других разработчиков и инженеров. "Нейронная сеть основанная на физических законах предназначена  для точного прогнозирования провисания провода под воздействием силы тяжести и при различных воздействиях окружающей среды, гарантируя, что все прогнозы соответствуют фундаментальным физическим законам механики тяжелой нерастежимой нити".
```
